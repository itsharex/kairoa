import { writable, derived } from 'svelte/store';
import { browser } from '$app/environment';

export type Locale = 'en' | 'zh';

const translations = {
  en: {
    app: {
      title: 'Kairoa',
      subtitle: 'Desktop Utility Tools'
    },
    home: {
      searchPlaceholder: 'Search tools...',
      resultsFound: 'results found',
      noResults: 'No results found',
      noResultsDesc: 'Try adjusting your search terms',
      apiClientDesc: 'Test and debug REST APIs with a powerful client',
      hashDesc: 'Calculate MD5, SHA-1, SHA-256, SHA-512 hashes',
      timeDesc: 'Convert between timestamps and dates',
      uuidDesc: 'Generate UUIDs and ULIDs',
      jsonDesc: 'Format, validate, and beautify JSON',
      crontabDesc: 'Calculate and validate cron expressions',
      encodeDecodeDesc: 'Encode/decode Base64, URL, ASCII, and JWT',
      cryptoDesc: 'Key generation, encryption, hashing, and BIP39',
      textProcessingDesc: 'Text statistics, diff, and case conversion',
      previewerDesc: 'Preview SVG, Markdown, and Mermaid diagrams',
      imageToolsDesc: 'Rotate and scale images',
      colorDesc: 'Convert between color formats (HEX, RGB, HSL)',
      baseConverterDesc: 'Convert between number bases (binary, octal, decimal, hex)',
      qrCodeDesc: 'Generate QR codes from text or URLs'
    },
    nav: {
      hash: 'Hash Calculator',
      time: 'Time Converter',
      uuid: 'UUID/ULID Generator',
      json: 'JSON Formatter',
      encodeDecode: 'Encode/Decode',
      textProcessing: 'Text Processing',
      textStats: 'Text Statistics',
      crontab: 'Crontab Calculator',
      color: 'Color Converter',
      baseConverter: 'Base Converter',
      crypto: 'Crypto',
      jwt: 'JWT Decoder',
      textDiff: 'Text Diff',
      previewer: 'Previewer',
      apiClient: 'REST API Client',
      imageTools: 'Image Tools',
      qrCode: 'QR Code Generator',
      settings: 'Settings'
    },
    imageTools: {
      title: 'Image Tools',
      selectImage: 'Select Image',
      dragDropImage: 'Click to select or drag and drop an image',
      supportedFormats: 'Supports PNG, JPG, GIF, WebP, etc.',
      invalidImageType: 'Please select a valid image file',
      noImageSelected: 'Please select an image first',
      processing: 'Processing...',
      download: 'Download',
      clear: 'Clear',
      original: 'Original',
      processed: 'Processed',
      saveSuccess: '✓ Image saved successfully',
      saveFailed: 'Failed to save image',
      downloadStarted: '✓ Download started',
      rotate: {
        title: 'Rotate',
        angle: 'Rotation Angle',
        apply: 'Apply Rotation'
      },
      scale: {
        title: 'Scale',
        apply: 'Apply Scale',
        width: 'Width',
        height: 'Height',
        maintainAspectRatio: 'Maintain Aspect Ratio',
        originalSize: 'Original Size',
        invalidDimensions: 'Invalid dimensions'
      },
      convert: {
        title: 'Format Convert',
        converted: 'Converted',
        targetFormat: 'Target Format',
        convert: 'Convert',
        previewPlaceholder: 'Converted image will appear here'
      }
    },
    hash: {
      title: 'Hash Calculator',
      input: 'Input Text',
      file: 'File',
      subtitle: 'Enter text content to calculate Hash',
      placeholder: 'Please enter text...',
      filePlaceholder: 'Click to select a file or drag and drop',
      calculate: 'Calculate Hash',
      calculating: 'Calculating...',
      clear: 'Clear',
      algorithms: {
        md5: 'MD5',
        sha1: 'SHA-1',
        sha224: 'SHA-224',
        sha256: 'SHA-256',
        sha384: 'SHA-384',
        sha512: 'SHA-512',
        ripemd160: 'RIPEMD-160'
      },
      algorithmDescriptions: {
        md5: '128-bit hash',
        sha1: '160-bit hash',
        sha224: '224-bit hash',
        sha256: '256-bit hash',
        sha384: '384-bit hash',
        sha512: '512-bit hash',
        ripemd160: '160-bit hash'
      },
      result: 'Result'
    },
    time: {
      title: 'Time Converter',
      timestamp: 'Timestamp',
      date: 'Date',
      timezone: 'Timezone',
      convert: 'Convert',
      clear: 'Clear',
      now: 'Now',
      timestampToDate: 'Timestamp → Date',
      dateToTimestamp: 'Date → Timestamp',
      searchTimezone: 'Search timezone...',
      noTimezoneFound: 'No matching timezone found'
    },
    uuid: {
      title: 'UUID/ULID Generator',
      generate: 'Generate',
      copy: 'Copy',
      generated: 'Generated UUIDs',
      generatedULID: 'Generated ULIDs',
      copyAll: 'Copy All',
      clear: 'Clear',
      count: 'Count',
      includeHyphens: 'Include "-"'
    },
    common: {
      copy: 'Copy',
      copied: 'Copied!',
      clear: 'Clear',
      close: 'Close'
    },
    sidebar: {
      expand: 'Expand sidebar',
      collapse: 'Collapse sidebar'
    },
    update: {
      check: 'Check for Updates',
      checking: 'Checking...',
      available: 'Update Available',
      latest: 'You are using the latest version',
      currentVersion: 'Current Version',
      latestVersion: 'Latest Version',
      download: 'Download',
      downloading: 'Downloading...',
      downloadProgress: 'Download Progress',
      downloadComplete: 'Download Complete',
      restartToUpdate: 'Restart to Update',
      restartConfirm: 'The update has been downloaded. Do you want to restart the application now?',
      restartLater: 'Restart Later',
      error: 'Failed to check for updates',
      releaseNotes: 'Release Notes'
    },
    settings: {
      title: 'Settings',
      appearance: 'Appearance',
      theme: 'Theme',
      language: 'Language',
      languageDescription: 'Choose your preferred language',
      lightMode: 'Light Mode',
      darkMode: 'Dark Mode',
      updates: 'Updates',
      checkForUpdates: 'Check for Updates',
      checkingUpdates: 'Checking for updates...',
      currentVersion: 'Current Version',
      latestVersion: 'Latest Version'
    },
    encodeDecode: {
      encode: 'Encode',
      decode: 'Decode',
      encodeBase64Placeholder: 'Enter text to encode...',
      decodeBase64Placeholder: 'Enter Base64 to decode...',
      encodeURLPlaceholder: 'Enter text to encode...',
      decodeURLPlaceholder: 'Enter URL encoded text...',
      encodeASCIIPlaceholder: 'Enter text to encode...',
      decodeASCIIPlaceholder: 'Enter Unicode escape sequence (e.g., \\u4f60\\u597d)...',
      encodeImageBase64Placeholder: 'Enter Base64 image data...',
      decodeImageBase64Placeholder: 'Enter Base64 image data...',
      selectImage: 'Click to select an image or drag and drop',
      dragDropImage: 'Supports PNG, JPG, GIF, etc.',
      clickToSelectImage: 'Click to select another image',
      download: 'Download',
      downloadImage: 'Download image',
      clear: 'Clear',
      result: 'Result',
      plaintext: 'Plaintext',
      base64: 'Base64',
      urlEncoded: 'URL Encoded',
      ascii: 'ASCII',
      image: 'Image',
      imageBase64: 'Image/Base64',
      base64Encode: 'BASE64 Encode',
      base64Decode: 'BASE64 Decode',
      urlEncode: 'URL Encode',
      urlDecode: 'URL Decode'
    },
    crontab: {
      title: 'Crontab Calculator',
      expression: 'Crontab Expression',
      placeholder: 'e.g., 0 9 * * 1-5',
      format: 'Format: minute hour day month weekday (e.g., 0 9 * * 1-5)',
      description: 'Description',
      nextRuns: 'Future Execution Times',
      clear: 'Clear',
      invalidExpression: 'Invalid crontab expression',
      parseError: 'Failed to parse expression',
      everyMinute: 'Every minute',
      atMinute: 'At minute {minute}',
      atMinutes: 'At minutes {minutes}',
      everyHour: 'Every hour',
      atHour: 'At hour {hour}',
      atHours: 'At hours {hours}',
      everyDay: 'Every day',
      onDay: 'On day {day}',
      onDays: 'On days {days}',
      everyMonth: 'Every month',
      inMonth: 'In {month}',
      inMonths: 'In specified months',
      onWeekday: 'On {weekday}',
      onWeekdays: 'On specified weekdays'
    },
    color: {
      title: 'Color Converter',
      inputFormat: 'Input Format',
      outputFormat: 'Output Format',
      input: 'Input',
      output: 'Output',
      clear: 'Clear',
      placeholder: {
        hex: 'e.g., #FF5733 or FF5733',
        rgb: 'e.g., rgb(255, 87, 51)',
        rgba: 'e.g., rgba(255, 87, 51, 0.8)',
        hsl: 'e.g., hsl(9, 100%, 60%)',
        hsla: 'e.g., hsla(9, 100%, 60%, 0.8)'
      },
      invalidHex: 'Invalid HEX color',
      invalidRGB: 'Invalid RGB/RGBA color',
      invalidHSL: 'Invalid HSL/HSLA color',
      parseError: 'Failed to parse color',
      convertError: 'Failed to convert color'
    },
    baseConverter: {
      title: 'Base Converter',
      inputBase: 'Input Base',
      outputBase: 'Output Base',
      input: 'Input',
      output: 'Output',
      clear: 'Clear',
      binary: 'Binary',
      octal: 'Octal',
      decimal: 'Decimal',
      hexadecimal: 'Hexadecimal',
      inputPlaceholder: 'Enter number...',
      invalidInput: 'Invalid {base} number',
      parseError: 'Failed to parse number',
      convertError: 'Failed to convert number'
    },
    textStats: {
      title: 'Text Statistics',
      placeholder: 'Enter text to analyze...',
      clear: 'Clear',
      statistics: 'Statistics',
      charactersWithSpaces: 'Characters (with spaces)',
      charactersWithoutSpaces: 'Characters (without spaces)',
      words: 'Words',
      lines: 'Lines',
      paragraphs: 'Paragraphs',
      chineseCharacters: 'Chinese Characters',
      englishCharacters: 'English Characters',
      numbers: 'Numbers',
      punctuation: 'Punctuation'
    },
    keyGenerator: {
      title: 'Asymmetric Key Generator',
      algorithm: 'Algorithm',
      keySize: 'Key Size',
      keyFormat: 'Key Format',
      generate: 'Generate Key Pair',
      generating: 'Generating...',
      clear: 'Clear',
      publicKey: 'Public Key',
      privateKey: 'Private Key',
      warning: 'Warning:',
      warningDescription: 'Keep your private key secure and never share it with anyone. The private key is sensitive information that should be protected.',
      rsaDescription: 'RSA: Encryption/Decryption and Digital Signatures',
      dsaDescription: 'DSA: Digital Signatures Only (requires desktop app)',
      ecdsaDescription: 'ECDSA: Elliptic Curve Digital Signatures',
      ecdhDescription: 'ECDH: Elliptic Curve Key Exchange',
      sm2Description: 'SM2: Chinese National Standard Elliptic Curve Cryptography (Encryption/Decryption/Sign/Verify)',
      curve: 'Curve',
      tauriRequired: 'Desktop App Required',
      tauriRequiredDescription: 'DSA key generation requires the desktop application (Tauri environment). This feature is not available in the browser.',
      dsaGenerating: 'Generating DSA key pair... This may take 10-30 seconds depending on key size. Please wait.',
      deprecated: 'Deprecated',
      recommended: 'Recommended',
      slower: 'Slower',
      dsaKeySizeHint: '2048 bits offers a good balance of security and generation speed. 3072 bits may take 20-30 seconds to generate.'
    },
    crypto: {
      keyGenerator: 'Key Generator',
      hash: {
        title: 'Password Hash',
        algorithm: 'Algorithm',
        operation: 'Operation',
        hash: 'Hash',
        verify: 'Verify',
        password: 'Password',
        passwordPlaceholder: 'Enter password...',
        passwordRequired: 'Password is required',
        salt: 'Salt',
        saltPlaceholder: 'Enter salt or auto-generate',
        saltHint: 'Salt adds security. Leave empty to auto-generate.',
        generateSalt: 'Generate Salt',
        iterations: 'Iterations',
        iterationsHint: 'Recommended 100,000+. More iterations = more secure but slower.',
        keyLength: 'Key Length (bytes)',
        keyLengthHint: 'Output hash length, typically 32 bytes (256 bits)',
        output: 'Output',
        hashing: 'Hashing...',
        hashToVerify: 'Hash to Verify',
        hashToVerifyPlaceholder: 'Paste hash to verify...',
        hashRequired: 'Hash is required',
        verifySuccess: '✓ Password verified successfully',
        verifyFailed: '✗ Password verification failed',
        tauriRequired: 'Password hashing requires the desktop application (Tauri environment). This feature is not available in the browser.',
        cost: 'Cost Factor',
        costHint: 'Recommended 12-14. Higher cost = more secure but slower.',
        memory: 'Memory (KB)',
        memoryHint: 'Memory usage in KB. Recommended 65536 (64 MB).',
        parallelism: 'Parallelism'
      },
      bip39: {
        title: 'BIP39 Mnemonic',
        operation: 'Operation',
        generate: 'Generate Mnemonic',
        validate: 'Validate Mnemonic',
        toSeed: 'Mnemonic to Seed',
        toEntropy: 'Mnemonic/Entropy Conversion',
        language: 'Language',
        strength: 'Entropy Strength',
        mnemonic: 'Mnemonic',
        mnemonicPlaceholder: 'Enter or paste mnemonic phrase...',
        passphrase: 'Passphrase',
        passphrasePlaceholder: 'Enter optional passphrase...',
        passphraseHint: 'Passphrase adds an extra layer of security. If forgotten, the seed cannot be recovered.',
        optional: 'Optional',
        seed: 'Seed (Hex)',
        entropy: 'Entropy (Hex)',
        entropyPlaceholder: 'Enter entropy in hexadecimal format...',
        generateMnemonic: 'Generate Mnemonic',
        validateMnemonic: 'Validate Mnemonic',
        generateSeed: 'Generate Seed',
        mnemonicToEntropy: 'Mnemonic → Entropy',
        entropyToMnemonic: 'Entropy → Mnemonic',
        mnemonicRequired: 'Mnemonic is required',
        invalidMnemonic: 'Invalid mnemonic phrase',
        validMnemonic: 'Mnemonic phrase is valid',
        entropyRequired: 'Entropy is required',
        invalidEntropy: 'Invalid entropy format',
        invalidEntropyLength: 'Entropy must be 16, 20, 24, 28, or 32 bytes',
        languages: {
          english: 'English',
          spanish: 'Spanish',
          french: 'French',
          italian: 'Italian',
          portuguese: 'Portuguese',
          czech: 'Czech',
          japanese: 'Japanese',
          korean: 'Korean',
          simplifiedChinese: 'Simplified Chinese',
          traditionalChinese: 'Traditional Chinese'
        }
      },
      asymmetric: {
        title: 'Asymmetric Algorithm',
        algorithm: 'Algorithm',
        operation: 'Operation',
        encrypt: 'Encrypt',
        decrypt: 'Decrypt',
        sign: 'Sign',
        verify: 'Verify',
        keyExchange: 'Key Exchange',
        namedCurve: 'Named Curve',
        publicKey: 'Public Key',
        publicKeyPlaceholder: 'Enter public key in PEM format...',
        privateKey: 'Private Key',
        privateKeyPlaceholder: 'Enter private key in PEM format...',
        peerPublicKey: 'Peer Public Key',
        peerPublicKeyPlaceholder: 'Enter peer public key in PEM format...',
        peerPublicKeyRequired: 'Peer public key is required',
        plaintext: 'Plaintext',
        ciphertext: 'Ciphertext',
        message: 'Message',
        messageAndSignature: 'Message and Signature',
        messageAndSignaturePlaceholder: 'Format: message|signature (Base64)',
        signature: 'Signature',
        sharedSecret: 'Shared Secret',
        verificationResult: 'Verification Result',
        inputPlaceholder: 'Enter text...',
        outputPlaceholder: 'Result will appear here...',
        notApplicable: 'N/A',
        notSupported: 'Not Supported',
        publicKeyRequired: 'Public key is required',
        privateKeyRequired: 'Private key is required',
        inputRequired: 'Input is required',
        invalidFormat: 'Invalid format. Expected: message|signature',
        verificationSuccess: '✓ Signature is valid',
        verificationFailed: '✗ Signature is invalid',
        dsaNotSupported: 'DSA is not supported by Web Crypto API. Please use ECDSA or RSA-PSS for digital signatures.',
        dsaTauriRequired: 'DSA requires the desktop app (Tauri environment). This feature is not available in the browser.',
        signatureValid: '✓ Signature is valid',
        signatureInvalid: '✗ Signature is invalid',
        messageRequired: 'Message is required',
        messageAndSignatureRequired: 'Message and signature are required (format: message|signature)',
        invalidMessageSignatureFormat: 'Invalid format. Expected: message|signature',
        dsaInfo: 'Note:',
        dsaInfoDescription: 'DSA only supports digital signatures (sign/verify), not encryption. Messages are automatically hashed with SHA-256 before signing. No length limit on input messages.'
      },
      symmetric: {
        title: 'Symmetric Algorithm',
        algorithm: 'Algorithm',
        mode: 'Mode',
        key: 'Key',
        keyPlaceholder: 'Enter key',
        keyDescription: 'Key must be 16, 24, or 32 bytes (128, 192, or 256 bits)',
        generateKey: 'Generate Key',
        iv: 'IV (Initialization Vector)',
        ivPlaceholder: 'Enter IV or leave empty to generate automatically',
        ivDescription: 'IV is required for decryption. AES-GCM uses 12 bytes, AES-CBC uses 16 bytes',
        encrypt: 'Encrypt',
        decrypt: 'Decrypt',
        plaintext: 'Plaintext',
        plaintextPlaceholder: 'Enter text to encrypt...',
        ciphertext: 'Ciphertext',
        ciphertextPlaceholder: 'Encrypted result will appear here...',
        keyRequired: 'Key is required',
        inputRequired: 'Input is required',
        plaintextRequired: 'Plaintext is required',
        ciphertextRequired: 'Ciphertext is required',
        ivRequired: 'IV is required',
        invalidKeyLength: 'Invalid key length',
        invalidIvLength: 'Invalid IV length'
      }
    },
    jwt: {
      title: 'JWT Decoder',
      subtitle: 'Decode and inspect JWT (JSON Web Token) tokens',
      input: 'JWT Token',
      placeholder: 'Paste your JWT token here (e.g., eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...)',
      decode: 'Decode',
      header: 'Header',
      payload: 'Payload',
      signature: 'Signature',
      noHeader: 'No header',
      noPayload: 'No payload',
      noSignature: 'No signature',
      signatureHint: 'Note: The signature is a cryptographic hash and cannot be decoded. It is used to verify the token integrity.'
    },
    textDiff: {
      title: 'Text Diff',
      oldText: 'Old Text',
      newText: 'New Text',
      oldTextPlaceholder: 'Enter the original text...',
      newTextPlaceholder: 'Enter the new text...',
      diff: 'Difference',
      deleted: 'Deleted',
      inserted: 'Inserted',
      modified: 'Modified'
    },
    textCase: {
      title: 'Case Converter',
      input: 'Input Text',
      inputPlaceholder: 'Enter text to convert...',
      output: 'Converted Text',
      outputPlaceholder: 'Converted text will appear here...',
      clear: 'Clear',
      copy: 'Copy',
      copied: 'Copied',
      caseType: 'Case Type',
      uppercase: 'UPPERCASE',
      lowercase: 'lowercase',
      titleCase: 'Title Case',
      sentenceCase: 'Sentence case',
      capitalize: 'Capitalize',
      camelCase: 'camelCase',
      pascalCase: 'PascalCase',
      snakeCase: 'snake_case',
      kebabCase: 'kebab-case',
      constantCase: 'CONSTANT_CASE',
      dotCase: 'dot.case',
      pathCase: 'path/case',
      trainCase: 'Train-Case',
      cobolCase: 'COBOL-CASE',
      flatCase: 'flatcase',
      alternatingCase: 'aLtErNaTiNg',
      randomCase: 'RaNdOm',
      toggleCase: 'tOGGLE cASE'
    },
    previewer: {
      svg: 'SVG Preview',
      markdown: 'Markdown Preview',
      mermaid: 'Mermaid Preview',
      svgInput: 'SVG Code',
      markdownInput: 'Markdown',
      mermaidInput: 'Mermaid Code',
      svgPlaceholder: 'Paste your SVG code here...',
      markdownPlaceholder: 'Enter Markdown content...',
      mermaidPlaceholder: 'Enter Mermaid diagram code...',
      svgPreviewPlaceholder: 'Preview will appear here',
      markdownPreviewPlaceholder: 'Preview will appear here',
      mermaidPreviewPlaceholder: 'Preview will appear here',
      preview: 'Preview',
      invalidSVG: 'Invalid SVG',
      invalidSVGMessage: 'Please enter valid SVG code',
      selectFile: 'Select File',
      exportImage: 'Export as Image',
      fullscreen: 'Fullscreen',
      exitFullscreen: 'Exit Fullscreen'
    },
    apiClient: {
      urlPlaceholder: 'Enter API URL...',
      urlRequired: 'URL is required',
      send: 'Send',
      sending: 'Sending...',
      clear: 'Clear',
      headers: 'Headers',
      headerKey: 'Key',
      headerValue: 'Value',
      addHeader: 'Add Header',
      bulkAdd: 'Bulk Add',
      bulkAddHeaders: 'Bulk Add Headers',
      bulkAddHeadersHint: 'Enter headers in the format "key: value" or "key=value", one per line',
      bulkAddHeadersPlaceholder: 'Content-Type: application/json\nAuthorization: Bearer token123\nUser-Agent: MyApp/1.0',
      cancel: 'Cancel',
      add: 'Add',
      body: 'Body',
      jsonPlaceholder: 'Enter JSON body...',
      textPlaceholder: 'Enter text body...',
      xmlPlaceholder: 'Enter XML body...',
      formKey: 'Key',
      formValue: 'Value',
      addFormData: 'Add Form Data',
      selectFile: 'Select File',
      invalidJson: 'Invalid JSON format',
      requestFailed: 'Request failed',
      response: 'Response',
      status: 'Status',
      responseHeaders: 'Response Headers',
      responseBody: 'Response Body',
      noHeaders: 'No headers',
      noResponseBody: 'No response body',
      importCurl: 'Import cURL',
      exportCurl: 'Export cURL',
      importCurlHint: 'Paste your cURL command below and click Import to load the request configuration.',
      importCurlPlaceholder: 'curl -X POST "https://api.example.com/endpoint" -H "Content-Type: application/json" -d \'{"key":"value"}\'',
      exportCurlHint: 'Copy the generated cURL command below.',
      invalidCurlCommand: 'Invalid cURL command format',
      import: 'Import',
      close: 'Close',
      showCode: 'Show code',
      clearAll: 'Clear all'
    },
    qrCode: {
      title: 'QR Code Generator',
      input: 'Input',
      inputPlaceholder: 'Enter text or URL to generate QR code...',
      inputRequired: 'Please enter text or URL',
      generate: 'Generate',
      generating: 'Generating...',
      size: 'Size',
      margin: 'Margin',
      colorDark: 'Dark Color',
      colorLight: 'Light Color',
      errorCorrectionLevel: 'Error Correction Level',
      errorCorrectionL: 'Low',
      errorCorrectionM: 'Medium',
      errorCorrectionQ: 'Quartile',
      errorCorrectionH: 'High',
      copy: 'Copy',
      copied: 'Copied',
      download: 'Download',
      clear: 'Clear',
      logo: 'Logo',
      selectLogo: 'Select Logo',
      removeLogo: 'Remove',
      logoSize: 'Logo Size (%)',
      invalidLogoType: 'Please select a valid image file',
      saveSuccess: '✓ QR code saved successfully',
      saveFailed: 'Failed to save QR code',
      downloadStarted: '✓ Download started'
    }
  },
  zh: {
    app: {
      title: '清漪',
      subtitle: '桌面工具集'
    },
    home: {
      searchPlaceholder: '搜索工具...',
      resultsFound: '个结果',
      noResults: '未找到结果',
      noResultsDesc: '请尝试调整搜索关键词',
      apiClientDesc: '强大的 REST API 测试和调试客户端',
      hashDesc: '计算 MD5、SHA-1、SHA-256、SHA-512 哈希值',
      timeDesc: '时间戳和日期之间的转换',
      uuidDesc: '生成 UUID 和 ULID',
      jsonDesc: '格式化、验证和美化 JSON',
      crontabDesc: '计算和验证 cron 表达式',
      encodeDecodeDesc: 'Base64、URL、ASCII 和 JWT 编解码',
      cryptoDesc: '密钥生成、加密、哈希和 BIP39',
      textProcessingDesc: '文本统计、差异对比和大小写转换',
      previewerDesc: '预览 SVG、Markdown 和 Mermaid 图表',
      imageToolsDesc: '旋转和缩放图片',
      colorDesc: '颜色格式转换（HEX、RGB、HSL）',
      baseConverterDesc: '数字进制转换（二进制、八进制、十进制、十六进制）'
    },
    nav: {
      hash: 'Hash 计算器',
      time: '时间转换',
      uuid: 'UUID/ULID 生成器',
      json: 'JSON 格式化',
      encodeDecode: '编解码',
      textProcessing: '文本处理',
      textStats: '文本统计',
      crontab: 'Crontab 计算器',
      color: '颜色转换',
      baseConverter: '进制转换',
      crypto: '加解密',
      jwt: 'JWT 解码器',
      textDiff: '文本差异对比',
      previewer: '预览器',
      apiClient: 'REST API 客户端',
      imageTools: '图片处理',
      qrCode: '二维码生成器',
      settings: '设置'
    },
    imageTools: {
      title: '图片处理',
      selectImage: '选择图片',
      dragDropImage: '点击选择或拖拽图片到此处',
      supportedFormats: '支持 PNG、JPG、GIF、WebP 等格式',
      invalidImageType: '请选择有效的图片文件',
      noImageSelected: '请先选择图片',
      processing: '处理中...',
      download: '下载',
      clear: '清空',
      original: '原图',
      processed: '处理后',
      saveSuccess: '✓ 图片保存成功',
      saveFailed: '保存图片失败',
      downloadStarted: '✓ 下载已开始',
      rotate: {
        title: '旋转',
        angle: '旋转角度',
        apply: '应用旋转'
      },
      scale: {
        title: '缩放',
        apply: '应用缩放',
        width: '宽度',
        height: '高度',
        maintainAspectRatio: '保持宽高比',
        originalSize: '原始尺寸',
        invalidDimensions: '无效的尺寸'
      },
      convert: {
        title: '格式转换',
        converted: '转换后',
        targetFormat: '目标格式',
        convert: '转换',
        previewPlaceholder: '转换后的图片将显示在这里'
      }
    },
    hash: {
      title: '哈希计算器',
      input: '输入文本',
      file: '文件',
      subtitle: '输入需要计算 Hash 的文本内容',
      placeholder: '请输入文本...',
      filePlaceholder: '点击选择文件或拖拽文件到此处',
      calculate: '计算 Hash',
      calculating: '计算中...',
      clear: '清空',
      algorithms: {
        md5: 'MD5',
        sha1: 'SHA-1',
        sha224: 'SHA-224',
        sha256: 'SHA-256',
        sha384: 'SHA-384',
        sha512: 'SHA-512',
        ripemd160: 'RIPEMD-160'
      },
      algorithmDescriptions: {
        md5: '128-bit hash',
        sha1: '160-bit hash',
        sha224: '224-bit hash',
        sha256: '256-bit hash',
        sha384: '384-bit hash',
        sha512: '512-bit hash',
        ripemd160: '160-bit hash'
      },
      result: '结果'
    },
    time: {
      title: '时间转换器',
      timestamp: '时间戳',
      date: '日期',
      timezone: '时区',
      convert: '转换',
      clear: '清空',
      now: '当前时间',
      timestampToDate: '时间戳 → 日期',
      dateToTimestamp: '日期 → 时间戳',
      searchTimezone: '搜索时区...',
      noTimezoneFound: '未找到匹配的时区'
    },
    uuid: {
      title: 'UUID/ULID 生成器',
      generate: '生成',
      copy: '复制',
      generated: '生成的 UUID',
      generatedULID: '生成的 ULID',
      copyAll: '复制全部',
      clear: '清空',
      count: '数量',
      includeHyphens: '包含"-"'
    },
    common: {
      copy: '复制',
      copied: '已复制!',
      clear: '清除',
      close: '关闭'
    },
    sidebar: {
      expand: '展开侧边栏',
      collapse: '收起侧边栏'
    },
    update: {
      check: '检查更新',
      checking: '检查中...',
      available: '有新版本可用',
      latest: '您使用的是最新版本',
      currentVersion: '当前版本',
      latestVersion: '最新版本',
      download: '下载',
      downloading: '正在下载...',
      downloadProgress: '下载进度',
      downloadComplete: '下载完成',
      restartToUpdate: '重启以更新',
      restartConfirm: '更新已下载完成。是否立即重启应用程序？',
      restartLater: '稍后重启',
      error: '检查更新失败',
      releaseNotes: '更新说明'
    },
    settings: {
      title: '设置',
      appearance: '外观',
      theme: '主题',
      language: '语言',
      languageDescription: '选择您偏好的语言',
      lightMode: '浅色模式',
      darkMode: '深色模式',
      updates: '更新',
      checkForUpdates: '检查更新',
      checkingUpdates: '正在检查更新...',
      currentVersion: '当前版本',
      latestVersion: '最新版本'
    },
    encodeDecode: {
      encode: '编码',
      decode: '解码',
      encodeBase64Placeholder: '输入要编码的文本...',
      decodeBase64Placeholder: '输入要解码的 Base64...',
      encodeURLPlaceholder: '输入要编码的文本...',
      decodeURLPlaceholder: '输入要解码的 URL 编码文本...',
      encodeASCIIPlaceholder: '输入要编码的文本...',
      decodeASCIIPlaceholder: '输入 Unicode 转义序列（例如：\\u4f60\\u597d）...',
      encodeImageBase64Placeholder: '输入 Base64 图片数据...',
      decodeImageBase64Placeholder: '输入 Base64 图片数据...',
      selectImage: '点击选择图片或拖拽图片到此处',
      dragDropImage: '支持 PNG、JPG、GIF 等格式',
      clickToSelectImage: '点击选择其他图片',
      download: '下载',
      downloadImage: '下载图片',
      clear: '清空',
      result: '结果',
      plaintext: '明文',
      base64: 'BASE64',
      urlEncoded: 'URL编码',
      ascii: 'ASCII',
      image: '图片',
      imageBase64: '图片/Base64',
      base64Encode: 'BASE64编码',
      base64Decode: 'BASE64解码',
      urlEncode: 'URL编码',
      urlDecode: 'URL解码'
    },
    crontab: {
      title: 'Crontab 计算器',
      expression: 'Crontab 表达式',
      placeholder: '例如：0 9 * * 1-5',
      format: '格式：分钟 小时 日期 月份 星期（例如：0 9 * * 1-5）',
      description: '说明',
      nextRuns: '未来执行时间点',
      clear: '清空',
      invalidExpression: '无效的 crontab 表达式',
      parseError: '解析表达式失败',
      everyMinute: '每分钟',
      atMinute: '在 {minute} 分',
      atMinutes: '在 {minutes} 分',
      everyHour: '每小时',
      atHour: '在 {hour} 时',
      atHours: '在 {hours} 时',
      everyDay: '每天',
      onDay: '在第 {day} 天',
      onDays: '在第 {days} 天',
      everyMonth: '每月',
      inMonth: '在 {month} 月',
      inMonths: '在指定月份',
      onWeekday: '在 {weekday}',
      onWeekdays: '在指定星期'
    },
    color: {
      title: '颜色转换器',
      inputFormat: '输入格式',
      outputFormat: '输出格式',
      input: '输入',
      output: '输出',
      clear: '清空',
      placeholder: {
        hex: '例如：#FF5733 或 FF5733',
        rgb: '例如：rgb(255, 87, 51)',
        rgba: '例如：rgba(255, 87, 51, 0.8)',
        hsl: '例如：hsl(9, 100%, 60%)',
        hsla: '例如：hsla(9, 100%, 60%, 0.8)'
      },
      invalidHex: '无效的 HEX 颜色',
      invalidRGB: '无效的 RGB/RGBA 颜色',
      invalidHSL: '无效的 HSL/HSLA 颜色',
      parseError: '解析颜色失败',
      convertError: '转换颜色失败'
    },
    baseConverter: {
      title: '进制转换器',
      inputBase: '输入进制',
      outputBase: '输出进制',
      input: '输入',
      output: '输出',
      clear: '清空',
      binary: '二进制',
      octal: '八进制',
      decimal: '十进制',
      hexadecimal: '十六进制',
      inputPlaceholder: '输入数字...',
      invalidInput: '无效的 {base} 进制数字',
      parseError: '解析数字失败',
      convertError: '转换数字失败'
    },
    textStats: {
      title: '文本统计',
      placeholder: '输入文本进行分析...',
      clear: '清空',
      statistics: '统计结果',
      charactersWithSpaces: '字符数（含空格）',
      charactersWithoutSpaces: '字符数（不含空格）',
      words: '单词数',
      lines: '行数',
      paragraphs: '段落数',
      chineseCharacters: '中文字符数',
      englishCharacters: '英文字符数',
      numbers: '数字',
      punctuation: '标点符号'
    },
    keyGenerator: {
      title: '非对称密钥生成器',
      algorithm: '算法',
      keySize: '密钥长度',
      keyFormat: '密钥格式',
      generate: '生成密钥对',
      generating: '生成中...',
      clear: '清空',
      publicKey: '公钥',
      privateKey: '私钥',
      warning: '警告：',
      warningDescription: '请妥善保管您的私钥，不要与任何人分享。私钥是敏感信息，应该受到保护。',
      rsaDescription: 'RSA：加密/解密和数字签名',
      dsaDescription: 'DSA：仅数字签名（需要桌面应用）',
      ecdsaDescription: 'ECDSA：椭圆曲线数字签名',
      ecdhDescription: 'ECDH：椭圆曲线密钥交换',
      sm2Description: 'SM2：国密椭圆曲线公钥密码算法（加密/解密/签名/验证）',
      curve: '曲线',
      tauriRequired: '需要桌面应用',
      tauriRequiredDescription: 'DSA 密钥生成需要桌面应用程序（Tauri 环境）。此功能在浏览器中不可用。',
      dsaGenerating: '正在生成 DSA 密钥对... 根据密钥长度，这可能需要 10-30 秒。请耐心等待。',
      deprecated: '已弃用',
      recommended: '推荐',
      slower: '较慢',
      dsaKeySizeHint: '2048 位提供良好的安全性和生成速度平衡。3072 位生成时间可能需要 20-30 秒。'
    },
    crypto: {
      keyGenerator: '密钥生成器',
      hash: {
        title: '密码哈希',
        algorithm: '算法',
        operation: '操作',
        hash: '哈希',
        verify: '验证',
        password: '密码',
        passwordPlaceholder: '输入密码...',
        passwordRequired: '需要输入密码',
        salt: '盐值',
        saltPlaceholder: '输入盐值或自动生成',
        saltHint: '盐值用于增强安全性。留空将自动生成。',
        generateSalt: '生成盐值',
        iterations: '迭代次数',
        iterationsHint: '推荐 100,000 次以上。更多迭代更安全但更慢。',
        keyLength: '密钥长度（字节）',
        keyLengthHint: '输出哈希的长度，通常为 32 字节（256 位）',
        output: '输出',
        hashing: '哈希中...',
        hashToVerify: '要验证的哈希',
        hashToVerifyPlaceholder: '粘贴要验证的哈希值...',
        hashRequired: '需要输入哈希值',
        verifySuccess: '✓ 密码验证成功',
        verifyFailed: '✗ 密码验证失败',
        tauriRequired: '密码哈希需要桌面应用程序（Tauri 环境）。此功能在浏览器中不可用。',
        cost: '成本因子',
        costHint: '推荐 12-14。更高的成本更安全但更慢。',
        memory: '内存 (KB)',
        memoryHint: '内存使用量（KB）。推荐 65536（64 MB）。',
        parallelism: '并行度'
      },
      bip39: {
        title: 'BIP39 助记词',
        operation: '操作',
        generate: '生成助记词',
        validate: '验证助记词',
        toSeed: '助记词转种子',
        toEntropy: '助记词/熵转换',
        language: '语言',
        strength: '熵强度',
        mnemonic: '助记词',
        mnemonicPlaceholder: '输入或粘贴助记词...',
        passphrase: '密码短语',
        passphrasePlaceholder: '输入可选的密码短语...',
        passphraseHint: '密码短语提供额外的安全层。如果忘记，种子将无法恢复。',
        optional: '可选',
        seed: '种子（十六进制）',
        entropy: '熵（十六进制）',
        entropyPlaceholder: '以十六进制格式输入熵...',
        generateMnemonic: '生成助记词',
        validateMnemonic: '验证助记词',
        generateSeed: '生成种子',
        mnemonicToEntropy: '助记词 → 熵',
        entropyToMnemonic: '熵 → 助记词',
        mnemonicRequired: '需要输入助记词',
        invalidMnemonic: '无效的助记词',
        validMnemonic: '助记词有效',
        entropyRequired: '需要输入熵',
        invalidEntropy: '无效的熵格式',
        invalidEntropyLength: '熵必须是 16、20、24、28 或 32 字节',
        languages: {
          english: '英语',
          spanish: '西班牙语',
          french: '法语',
          italian: '意大利语',
          portuguese: '葡萄牙语',
          czech: '捷克语',
          japanese: '日语',
          korean: '韩语',
          simplifiedChinese: '简体中文',
          traditionalChinese: '繁体中文'
        }
      },
      asymmetric: {
        title: '非对称算法',
        algorithm: '算法',
        operation: '操作',
        encrypt: '加密',
        decrypt: '解密',
        sign: '签名',
        verify: '验证',
        keyExchange: '密钥交换',
        namedCurve: '命名曲线',
        publicKey: '公钥',
        publicKeyPlaceholder: '输入 PEM 格式的公钥...',
        privateKey: '私钥',
        privateKeyPlaceholder: '输入 PEM 格式的私钥...',
        peerPublicKey: '对方公钥',
        peerPublicKeyPlaceholder: '输入对方公钥（PEM 格式）...',
        peerPublicKeyRequired: '需要对方公钥',
        plaintext: '明文',
        ciphertext: '密文',
        message: '消息',
        messageAndSignature: '消息和签名',
        messageAndSignaturePlaceholder: '格式：消息|签名 (Base64)',
        signature: '签名',
        sharedSecret: '共享密钥',
        verificationResult: '验证结果',
        inputPlaceholder: '输入文本...',
        outputPlaceholder: '结果将在此显示...',
        notApplicable: '不适用',
        notSupported: '不支持',
        publicKeyRequired: '需要公钥',
        privateKeyRequired: '需要私钥',
        inputRequired: '需要输入',
        invalidFormat: '格式无效。期望格式：消息|签名',
        verificationSuccess: '✓ 签名有效',
        verificationFailed: '✗ 签名无效',
        dsaNotSupported: 'DSA 不受 Web Crypto API 支持。请使用 ECDSA 或 RSA-PSS 进行数字签名。',
        dsaTauriRequired: 'DSA 需要桌面应用程序（Tauri 环境）。此功能在浏览器中不可用。',
        signatureValid: '✓ 签名有效',
        signatureInvalid: '✗ 签名无效',
        messageRequired: '需要输入消息',
        messageAndSignatureRequired: '需要输入消息和签名（格式：消息|签名）',
        invalidMessageSignatureFormat: '格式无效。期望格式：消息|签名',
        dsaInfo: '注意：',
        dsaInfoDescription: 'DSA 仅支持数字签名（签名/验证），不支持加密。消息会自动使用 SHA-256 哈希后再签名。输入消息无长度限制。'
      },
      symmetric: {
        title: '对称算法',
        algorithm: '算法',
        mode: '模式',
        key: '密钥',
        keyPlaceholder: '输入密钥',
        keyDescription: '密钥必须是 16、24 或 32 字节（128、192 或 256 位）',
        generateKey: '生成密钥',
        iv: 'IV (初始化向量)',
        ivPlaceholder: '输入 IV 或留空以自动生成',
        ivDescription: '解密时需要 IV。AES-GCM 使用 12 字节，AES-CBC 使用 16 字节',
        encrypt: '加密',
        decrypt: '解密',
        plaintext: '明文',
        plaintextPlaceholder: '输入要加密的文本...',
        ciphertext: '密文',
        ciphertextPlaceholder: '加密结果将在此显示...',
        keyRequired: '需要密钥',
        inputRequired: '需要输入',
        plaintextRequired: '需要明文',
        ciphertextRequired: '需要密文',
        ivRequired: '需要 IV',
        invalidKeyLength: '密钥长度无效',
        invalidIvLength: 'IV 长度无效'
      }
    },
    jwt: {
      title: 'JWT 解码器',
      subtitle: '解码和检查 JWT (JSON Web Token) 令牌',
      input: 'JWT 令牌',
      placeholder: '在此处粘贴您的 JWT 令牌（例如：eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...）',
      decode: '解码',
      header: '头部',
      payload: '载荷',
      signature: '签名',
      noHeader: '无头部',
      noPayload: '无载荷',
      noSignature: '无签名',
      signatureHint: '注意：签名是加密哈希值，无法解码。它用于验证令牌的完整性。'
    },
    textDiff: {
      title: '文本差异对比',
      oldText: '原始文本',
      newText: '新文本',
      oldTextPlaceholder: '输入原始文本...',
      newTextPlaceholder: '输入新文本...',
      diff: '差异对比',
      deleted: '已删除',
      inserted: '已插入',
      modified: '已修改'
    },
    textCase: {
      title: '大小写转换',
      input: '输入文本',
      inputPlaceholder: '输入要转换的文本...',
      output: '转换结果',
      outputPlaceholder: '转换后的文本将显示在这里...',
      clear: '清空',
      copy: '复制',
      copied: '已复制',
      caseType: '转换类型',
      uppercase: '全大写',
      lowercase: '全小写',
      titleCase: '标题大小写',
      sentenceCase: '句子大小写',
      capitalize: '首字母大写',
      camelCase: '驼峰命名',
      pascalCase: '帕斯卡命名',
      snakeCase: '蛇形命名',
      kebabCase: '烤肉串命名',
      constantCase: '常量命名',
      dotCase: '点分隔',
      pathCase: '路径分隔',
      trainCase: '火车命名',
      cobolCase: 'COBOL命名',
      flatCase: '扁平命名',
      alternatingCase: '交替大小写',
      randomCase: '随机大小写',
      toggleCase: '切换大小写'
    },
    previewer: {
      svg: 'SVG 预览',
      markdown: 'Markdown 预览',
      mermaid: 'Mermaid 预览',
      svgInput: 'SVG 代码',
      markdownInput: 'Markdown',
      mermaidInput: 'Mermaid 代码',
      svgPlaceholder: '在此处粘贴 SVG 代码...',
      markdownPlaceholder: '输入 Markdown 内容...',
      mermaidPlaceholder: '输入 Mermaid 图表代码...',
      svgPreviewPlaceholder: '预览将在此处显示',
      markdownPreviewPlaceholder: '预览将在此处显示',
      mermaidPreviewPlaceholder: '预览将在此处显示',
      preview: '预览',
      invalidSVG: '无效的 SVG',
      invalidSVGMessage: '请输入有效的 SVG 代码',
      selectFile: '选择文件',
      exportImage: '导出为图片',
      fullscreen: '全屏',
      exitFullscreen: '退出全屏'
    },
    apiClient: {
      urlPlaceholder: '输入 API URL...',
      urlRequired: 'URL 是必填项',
      send: '发送',
      sending: '发送中...',
      clear: '清空',
      headers: '请求头',
      headerKey: '键',
      headerValue: '值',
      addHeader: '添加请求头',
      bulkAdd: '批量添加',
      bulkAddHeaders: '批量添加请求头',
      bulkAddHeadersHint: '每行一个请求头，格式："key: value" 或 "key=value"',
      bulkAddHeadersPlaceholder: 'Content-Type: application/json\nAuthorization: Bearer token123\nUser-Agent: MyApp/1.0',
      cancel: '取消',
      add: '添加',
      body: '请求体',
      jsonPlaceholder: '输入 JSON 请求体...',
      textPlaceholder: '输入文本请求体...',
      xmlPlaceholder: '输入 XML 请求体...',
      formKey: '键',
      formValue: '值',
      addFormData: '添加表单数据',
      selectFile: '选择文件',
      invalidJson: 'JSON 格式无效',
      requestFailed: '请求失败',
      response: '响应',
      status: '状态码',
      responseHeaders: '响应头',
      responseBody: '响应体',
      noHeaders: '无响应头',
      noResponseBody: '无响应体',
      importCurl: '导入 cURL',
      exportCurl: '导出 cURL',
      importCurlHint: '在下方粘贴您的 cURL 命令，点击导入以加载请求配置。',
      importCurlPlaceholder: 'curl -X POST "https://api.example.com/endpoint" -H "Content-Type: application/json" -d \'{"key":"value"}\'',
      exportCurlHint: '复制下方生成的 cURL 命令。',
      invalidCurlCommand: 'cURL 命令格式无效',
      import: '导入',
      close: '关闭',
      showCode: '显示代码',
      clearAll: '清除全部'
    },
    qrCode: {
      title: '二维码生成器',
      input: '输入',
      inputPlaceholder: '输入文本或 URL 生成二维码...',
      inputRequired: '请输入文本或 URL',
      generate: '生成',
      generating: '生成中...',
      size: '尺寸',
      margin: '边距',
      colorDark: '深色',
      colorLight: '浅色',
      errorCorrectionLevel: '纠错级别',
      errorCorrectionL: '低',
      errorCorrectionM: '中',
      errorCorrectionQ: '四分位',
      errorCorrectionH: '高',
      copy: '复制',
      copied: '已复制',
      download: '下载',
      clear: '清空',
      logo: 'Logo',
      selectLogo: '选择 Logo',
      removeLogo: '移除',
      logoSize: 'Logo 大小 (%)',
      invalidLogoType: '请选择有效的图片文件',
      saveSuccess: '✓ 二维码保存成功',
      saveFailed: '保存二维码失败',
      downloadStarted: '✓ 下载已开始'
    }
  }
};

export type Translations = typeof translations.en;

function createLocaleStore() {
  const { subscribe, set, update } = writable<Locale>('en');

  return {
    subscribe,
    set: (locale: Locale) => {
      if (browser) {
        localStorage.setItem('locale', locale);
      }
      set(locale);
    },
    init: () => {
      if (browser) {
        const stored = localStorage.getItem('locale') as Locale | null;
        const locale = stored || 'en';
        set(locale);
      }
    },
    toggle: () => {
      update((current) => {
        const newLocale = current === 'en' ? 'zh' : 'en';
        if (browser) {
          localStorage.setItem('locale', newLocale);
        }
        return newLocale;
      });
    }
  };
}

export const locale = createLocaleStore();

// 创建响应式的翻译 store
export const translationsStore = derived(locale, ($locale) => {
  return translations[$locale];
});

// 响应式的翻译函数，在组件中使用时需要订阅
export function t(key: string): string {
  let translations: Translations | null = null;
  const unsubscribe = translationsStore.subscribe(t => {
    translations = t;
  });
  unsubscribe();
  
  if (!translations) return key;
  
  const keys = key.split('.');
  let value: any = translations;
  for (const k of keys) {
    value = value?.[k];
  }
  return value || key;
}

// 推荐使用这个函数，它返回一个响应式的翻译函数
export function useTranslations() {
  let $translations: Translations;
  const unsubscribe = translationsStore.subscribe(t => $translations = t);
  
  return {
    t: (key: string): string => {
      const keys = key.split('.');
      let value: any = $translations;
      for (const k of keys) {
        value = value?.[k];
      }
      return value || key;
    },
    locale,
    unsubscribe
  };
}

